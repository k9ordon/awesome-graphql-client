# Awesome GraphQL Client

GraphQL Client with file upload support for NodeJS and browser

![CI/CD](https://github.com/lynxtaa/awesome-graphql-client/workflows/CI/CD/badge.svg) [![npm version](https://badge.fury.io/js/awesome-graphql-client.svg)](https://badge.fury.io/js/awesome-graphql-client) [![Codecov](https://img.shields.io/codecov/c/github/lynxtaa/awesome-graphql-client)](https://codecov.io/gh/lynxtaa/awesome-graphql-client)

## Features

- [GraphQL File Upload](https://github.com/jaydenseric/graphql-multipart-request-spec) support
- Works in browsers and NodeJS
- Full Typescript support
- Supports queries generated by [graphql-tag](https://www.npmjs.com/package/graphql-tag)

## Install

```sh
# Install client
npm install awesome-graphql-client

# Install graphql if not present
npm install graphql
```

## Quick Start

### Browser

```js
import { AwesomeGraphQLClient } from 'awesome-graphql-client'
import gql from 'graphql-tag'

const client = new AwesomeGraphQLClient({ endpoint: '/graphql' })

// Query can be a string
const GetUsers = `
  query getUsers {
    users {
      id
    }
  }
`

// Also query be a compiled GraphQL AST
const UploadUserAvatar = gql`
  mutation uploadUserAvatar($userId: Int!, $file: Upload!) {
    updateUser(id: $userId, input: { avatar: $file }) {
      id
    }
  }
`

const file = document.querySelector('input#avatar').files[0]

client
  .request(GetUsers)
  .then((data) =>
    client.request(UploadUserAvatar, {
      id: data.users[0].id,
      file,
    }),
  )
  .then((data) => console.log(data))
  .catch((error) => console.log(error))
```

### NodeJS

```js
import { AwesomeGraphQLClient } from 'awesome-graphql-client'
import FormData from 'form-data'
import { createReadStream } from 'fs'
import gql from 'graphql-tag'
import fetch from 'node-fetch'

const client = new AwesomeGraphQLClient({
  endpoint: '/graphql',
  fetch,
  // FormData is required only if you're using file upload
  FormData,
})

const UploadUserAvatar = gql`
  mutation uploadUserAvatar($userId: Int!, $file: Upload!) {
    updateUser(id: $userId, input: { avatar: $file }) {
      id
    }
  }
`

client
  .request(UploadUserAvatar, { file: createReadStream('./avatar.img'), userId: 10 })
  .then((data) => console.log(data))
  .catch((error) => console.log(error))
```

### Typescript

```ts
type getUser = {
  user: { id: number; login: string } | null
}
type getUserVariables = { id: 10 }

// Query can be a string or compiled GraphQL AST
const query = gql`
  query getUser($id: Int!) {
    user {
      id
      login
    }
  }
`

client
  .request<getUser, getUserVariables>(query, { id: 10 })
  .then((data) => console.log(data))
  .catch((error) => console.log(error))
```
